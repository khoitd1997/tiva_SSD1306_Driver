/**
 * @file main.c
 * @author Khoi Trinh
 * @brief Contain example of various features for the ssd1306
 * @version 0.1
 * @date 2018-11-03
 *
 *
 */

#include <assert.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

#include "inc/hw_i2c.h"

#include "inc/hw_ints.h"

#include "inc/hw_memmap.h"

#include "inc/hw_types.h"

#include "driverlib/gpio.h"

#include "driverlib/i2c.h"

#include "driverlib/interrupt.h"

#include "driverlib/pin_map.h"

#include "driverlib/sysctl.h"

#include "driverlib/uart.h"

#include "utils/uartstdio.h"

#include "tiva_utils/bit_manipulation.h"

#include "ssd1306.h"
#include "ssd1306_info.h"
#include "ssd1306_utils.h"

#include "oled_font.h"
#include "oled_font_source_pro.h"

static uint8_t testPic[] = {
    // 'monochrome_1_resized', 128x32px
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x40, 0x40,
    0x20, 0x80, 0x80, 0x20, 0x80, 0x80, 0x40, 0x80, 0x00, 0xc0, 0x50, 0x00, 0xc0, 0x20, 0x80, 0x00,
    0x00, 0x00, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x80, 0x00, 0x80, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xe0, 0xe0, 0xf0, 0xf0, 0xe0, 0xf0, 0xf8, 0xf0, 0xe0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe8, 0xf0, 0xf8,
    0xf0, 0xe0, 0xe0, 0x80, 0x80, 0xc0, 0x40, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x02, 0x00,
    0x01, 0x04, 0x06, 0x08, 0x1d, 0x0a, 0x9d, 0x7c, 0x1e, 0x9e, 0x3e, 0x3a, 0x7e, 0x7e, 0x7e, 0xfe,
    0xfb, 0xfd, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xfd, 0xff, 0xfd, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xfe,
    0xff, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xfe, 0xfe, 0xfc, 0xff, 0xfc, 0xfe, 0xfe, 0xfc, 0xfe, 0xf0, 0xfa, 0xfc, 0xfc, 0xf8,
    0xf8, 0xf0, 0xf0, 0xf0, 0xf8, 0xf0, 0xf8, 0xf0, 0xf8, 0xe0, 0xf0, 0xf0, 0xe8, 0xf0, 0xd8, 0xa8,
    0xe8, 0xa0, 0xc8, 0x50, 0x60, 0x80, 0x28, 0x40, 0x20, 0x80, 0xa0, 0x00, 0x40, 0x00, 0x00, 0x00,
    0x5f, 0x7f, 0x4f, 0xaf, 0x8f, 0x77, 0xef, 0x5e, 0xeb, 0x5d, 0xd7, 0xef, 0xef, 0xd7, 0x57, 0xff,
    0xcf, 0xfe, 0xff, 0xfb, 0xff, 0xfb, 0xfe, 0xfc, 0x50, 0xb0, 0xfe, 0xfd, 0xfe, 0xfc, 0xfb, 0xfc,
    0xfe, 0xfc, 0xfa, 0xfc, 0xfa, 0xfa, 0xf5, 0xf2, 0xfa, 0xe4, 0xf4, 0xf8, 0xd8, 0xf8, 0xe0, 0xf4,
    0xd2, 0xe1, 0xc3, 0xe3, 0xf7, 0xe7, 0xe3, 0xf7, 0xff, 0xff, 0xef, 0xff, 0xef, 0xef, 0xef, 0xcf,
    0xcf, 0xef, 0xcf, 0xef, 0xdf, 0xef, 0xcf, 0xcf, 0xcf, 0x5f, 0xcf, 0x5f, 0xcf, 0x5f, 0x4f, 0x9f,
    0x1f, 0x0f, 0x1f, 0x3f, 0x1f, 0x1f, 0x3f, 0x3f, 0xbf, 0x37, 0x3f, 0x3f, 0x7f, 0x7f, 0x7b, 0x3d,
    0x33, 0x3e, 0xf9, 0x3d, 0x3a, 0xb7, 0x35, 0x39, 0x31, 0xbf, 0x39, 0x15, 0xbd, 0x1f, 0x1d, 0x1d,
    0x19, 0x95, 0x1c, 0x99, 0x0a, 0x95, 0x0e, 0x99, 0x86, 0x19, 0x0e, 0x19, 0x8e, 0x08, 0x0f, 0x08,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x08, 0x10, 0x00, 0x18, 0x20,
    0x08, 0x20, 0x18, 0x24, 0x1c, 0x28, 0x98, 0x6d, 0x58, 0xa8, 0x5c, 0xbd, 0x1c, 0x7d, 0x3c, 0xdc,
    0x5e, 0xfd, 0x9c, 0xfc, 0x3e, 0xfd, 0x7e, 0xfc, 0x3e, 0xfc, 0x5e, 0x7e, 0x5e, 0x3c, 0xbe, 0x5f,
    0xff, 0x3e, 0x7f, 0xde, 0xbe, 0x7e, 0x7f, 0x7e, 0x7f, 0x3f, 0x7e, 0xbe, 0xdf, 0x7e, 0x7f, 0x7f,
    0x7f, 0x7f, 0x7e, 0x3f, 0x7f, 0x7f, 0x7f, 0x7e, 0x7f, 0x7e, 0x7f, 0x3f, 0x7f, 0x7f, 0x7f, 0x7e,
    0x7f, 0x7f, 0x3f, 0x5f, 0xbf, 0x7f, 0xbf, 0x3f, 0x7f, 0x3f, 0x1f, 0xbf, 0x5f, 0x7f, 0x1f, 0x6f,
    0x1f, 0xbf, 0x0f, 0xff, 0x3f, 0x1f, 0x2f, 0x0b, 0x0f, 0x0e, 0x27, 0x1e, 0x2b, 0x27, 0x0f, 0x07,
    0x0f, 0x16, 0x0e, 0x03, 0x02, 0x05, 0x03, 0x02, 0x02, 0x05, 0x01, 0x02, 0x01, 0x00, 0x00, 0x01};

int main(void) {
  ssd1306Init();  // intialize hardware

  /*UART stuffs*/
  // Enable the GPIO Peripheral used by the UART.
  SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);
  while (!SysCtlPeripheralReady(SYSCTL_PERIPH_GPIOA)) {}
  // Enable UART0
  SysCtlPeripheralEnable(SYSCTL_PERIPH_UART0);
  while (!SysCtlPeripheralReady(SYSCTL_PERIPH_UART0)) {}
  // Configure GPIO Pins for UART mode.
  GPIOPinConfigure(GPIO_PA0_U0RX);
  GPIOPinConfigure(GPIO_PA1_U0TX);
  GPIOPinTypeUART(GPIO_PORTA_BASE, GPIO_PIN_0 | GPIO_PIN_1);
  // Use the internal 16MHz oscillator as the UART clock source.
  UARTClockSourceSet(UART0_BASE, UART_CLOCK_PIOSC);

  // Initialize the UART for console I/O.
  UARTStdioConfig(0, 115200, 16000000);
  UARTprintf("Starting sd1306 test\n");

  ssd1306TurnOn(true);    // turn on display and writes configs
  ssd1306ClearDisplay();  // clear display to avoid memory garbage

  ssd1306AdjustContrast(250);  // set contrast

  ssd1306PrintPic(testPic, 0, 127, 0, 3);  // print a picture
                                           //   ssd1306PrintString(
  //       "ABCDE14321L", 0, 0, source_pro_set);  // write on first line using source code pro font

  for (;;) {}
  return 0;
}
